import bcrypt from "bcryptjs";
import { DEFAULT_TRUST_SCORE } from "../constants";

// Deterministic fixture data — same data on every cold start
// All field names match Prisma schema exactly

function d(offsetDays: number): string {
    const date = new Date("2026-01-15T09:00:00.000Z");
    date.setDate(date.getDate() + offsetDays);
    return date.toISOString();
}

const HASH = bcrypt.hashSync("Password123!", 10);

export function seedMockDb() {
    // ─── Users ───────────────────────────────────────────────────────────────────
    const users: User[] = [
        {
            id: "user-super-1",
            email: "super@dmhicc.org",
            passwordHash: HASH,
            firstName: "Chidi",
            lastName: "Okonkwo",
            role: "SUPER_ADMIN" as unknown as UserRole,
            profilePicture: "https://picsum.photos/seed/super1/100/100",
            trustScore: 100,
            isActive: true,
            createdAt: d(-60),
            updatedAt: d(-1),
        },
        {
            id: "user-admin-1",
            email: "admin@dmhicc.org",
            passwordHash: HASH,
            firstName: "Ngozi",
            lastName: "Adeyemi",
            role: "ADMIN" as unknown as UserRole,
            profilePicture: "https://picsum.photos/seed/admin1/100/100",
            trustScore: 98,
            isActive: true,
            createdAt: d(-55),
            updatedAt: d(-2),
        },
        {
            id: "user-lead-1",
            email: "lead@dmhicc.org",
            passwordHash: HASH,
            firstName: "Emeka",
            lastName: "Nwosu",
            role: "TEAM_LEAD" as unknown as UserRole,
            profilePicture: "https://picsum.photos/seed/lead1/100/100",
            trustScore: 95,
            isActive: true,
            createdAt: d(-50),
            updatedAt: d(-3),
        },
        {
            id: "user-1",
            email: "user@dmhicc.org",
            passwordHash: HASH,
            firstName: "Adaeze",
            lastName: "Okafor",
            role: "USER" as unknown as UserRole,
            profilePicture: "https://picsum.photos/seed/user1/100/100",
            trustScore: 87,
            isActive: true,
            createdAt: d(-45),
            updatedAt: d(-4),
        },
        {
            id: "user-2",
            email: "tunde@dmhicc.org",
            passwordHash: HASH,
            firstName: "Tunde",
            lastName: "Babatunde",
            role: "USER" as unknown as UserRole,
            profilePicture: "https://picsum.photos/seed/user2/100/100",
            trustScore: 72,
            isActive: true,
            createdAt: d(-40),
            updatedAt: d(-5),
        },
    ];

    // ─── Campaigns ──────────────────────────────────────────────────────────────
    const campaigns: Campaign[] = [
        {
            id: "camp-1",
            title: "Easter Harvest Drive 2026",
            description: "Mobilize your network to join the Easter Sunday celebration and harvest.",
            content: "Share this campaign with friends, family, and colleagues. Invite them to the Easter service.",
            media: [],
            mediaType: "IMAGE" as unknown as CampaignMediaType,
            mediaUrl: "https://picsum.photos/seed/camp1/800/400",
            thumbnailUrl: "https://picsum.photos/seed/camp1/400/200",
            ctaText: "Join the Harvest",
            ctaUrl: "https://harvesters.org/easter",
            createdById: "user-admin-1",
            status: "ACTIVE" as unknown as CampaignStatus,
            goalType: "REFERRALS" as unknown as GoalType,
            goalTarget: 1000,
            goalCurrent: 347,
            startDate: d(-10),
            endDate: d(20),
            targetAudience: ["Youth", "Young Adults"],
            publishedAt: d(-10),
            viewCount: 4823,
            clickCount: 2140,
            shareCount: 891,
            likeCount: 612,
            participantCount: 347,
            createdAt: d(-12),
            updatedAt: d(-1),
        },
        {
            id: "camp-2",
            title: "Digital Outreach January",
            description: "Kick off the year with a digital outreach blitz across all channels.",
            content: "Share the gospel message across your digital networks. Every click counts.",
            media: [],
            mediaType: "VIDEO" as unknown as CampaignMediaType,
            mediaUrl: "https://picsum.photos/seed/camp2/800/400",
            thumbnailUrl: "https://picsum.photos/seed/camp2/400/200",
            ctaText: "Share Now",
            ctaUrl: "https://harvesters.org/outreach",
            createdById: "user-admin-1",
            status: "ACTIVE" as unknown as CampaignStatus,
            goalType: "SHARES" as unknown as GoalType,
            goalTarget: 5000,
            goalCurrent: 1823,
            startDate: d(-20),
            endDate: d(10),
            targetAudience: ["All Members"],
            publishedAt: d(-20),
            viewCount: 9210,
            clickCount: 4823,
            shareCount: 1823,
            likeCount: 1204,
            participantCount: 892,
            createdAt: d(-22),
            updatedAt: d(-2),
        },
        {
            id: "camp-3",
            title: "Community Giving Initiative",
            description: "Raise funds to support community development projects.",
            content: "Every donation makes a difference in someone's life.",
            media: [],
            mediaType: "IMAGE" as unknown as CampaignMediaType,
            mediaUrl: "https://picsum.photos/seed/camp3/800/400",
            thumbnailUrl: "https://picsum.photos/seed/camp3/400/200",
            ctaText: "Donate Now",
            ctaUrl: "https://harvesters.org/give",
            createdById: "user-admin-1",
            status: "ACTIVE" as unknown as CampaignStatus,
            goalType: "DONATIONS" as unknown as GoalType,
            goalTarget: 500000,
            goalCurrent: 187350,
            startDate: d(-15),
            endDate: d(15),
            targetAudience: ["All Members", "Donors"],
            publishedAt: d(-15),
            viewCount: 3891,
            clickCount: 2103,
            shareCount: 743,
            likeCount: 891,
            participantCount: 534,
            createdAt: d(-17),
            updatedAt: d(-3),
        },
        {
            id: "camp-4",
            title: "Youth Ignite Conference",
            description: "Get young people excited about the upcoming Youth Ignite Conference.",
            content: "Share the conference details widely. Free entry for first-time attendees.",
            media: [],
            mediaType: "IMAGE" as unknown as CampaignMediaType,
            mediaUrl: "https://picsum.photos/seed/camp4/800/400",
            thumbnailUrl: "https://picsum.photos/seed/camp4/400/200",
            ctaText: "Register Now",
            ctaUrl: "https://harvesters.org/ignite",
            createdById: "user-lead-1",
            status: "ACTIVE" as unknown as CampaignStatus,
            goalType: "PARTICIPANTS" as unknown as GoalType,
            goalTarget: 2000,
            goalCurrent: 812,
            startDate: d(-5),
            endDate: d(25),
            targetAudience: ["Youth", "Teenagers"],
            publishedAt: d(-5),
            viewCount: 5623,
            clickCount: 3401,
            shareCount: 1203,
            likeCount: 2341,
            participantCount: 812,
            createdAt: d(-7),
            updatedAt: d(-1),
        },
        {
            id: "camp-5",
            title: "Prayer Chain 2026",
            description: "A global prayer chain connecting members across all campuses.",
            content: "Join the prayer chain and receive daily prayer prompts.",
            media: [],
            mediaType: "TEXT" as unknown as CampaignMediaType,
            createdById: "user-super-1",
            status: "PAUSED" as unknown as CampaignStatus,
            goalType: "PARTICIPANTS" as unknown as GoalType,
            goalTarget: 10000,
            goalCurrent: 3421,
            startDate: d(-30),
            endDate: d(60),
            viewCount: 12043,
            clickCount: 7823,
            shareCount: 3421,
            likeCount: 4201,
            participantCount: 3421,
            createdAt: d(-35),
            updatedAt: d(-10),
        },
        {
            id: "camp-6",
            title: "New Members Onboarding Drive",
            description: "Help new members feel welcome and connected.",
            content: "Share the new members welcome pack with anyone who recently joined.",
            media: [],
            mediaType: "IMAGE" as unknown as CampaignMediaType,
            mediaUrl: "https://picsum.photos/seed/camp6/800/400",
            thumbnailUrl: "https://picsum.photos/seed/camp6/400/200",
            ctaText: "Welcome Pack",
            ctaUrl: "https://harvesters.org/welcome",
            createdById: "user-admin-1",
            status: "COMPLETED" as unknown as CampaignStatus,
            goalType: "SHARES" as unknown as GoalType,
            goalTarget: 1000,
            goalCurrent: 1124,
            startDate: d(-60),
            endDate: d(-5),
            publishedAt: d(-60),
            viewCount: 8901,
            clickCount: 5612,
            shareCount: 1124,
            likeCount: 943,
            participantCount: 634,
            createdAt: d(-62),
            updatedAt: d(-5),
        },
        {
            id: "camp-7",
            title: "Christmas Outreach Planning",
            description: "Plan and coordinate the Christmas outreach campaign for December.",
            content: "Draft campaign — details coming soon.",
            media: [],
            mediaType: "TEXT" as unknown as CampaignMediaType,
            createdById: "user-admin-1",
            status: "DRAFT" as unknown as CampaignStatus,
            goalType: "SHARES" as unknown as GoalType,
            goalTarget: 10000,
            goalCurrent: 0,
            viewCount: 0,
            clickCount: 0,
            shareCount: 0,
            likeCount: 0,
            participantCount: 0,
            createdAt: d(-2),
            updatedAt: d(-1),
        },
        {
            id: "camp-8",
            title: "Mid-Year Thanksgiving Drive",
            description: "Celebrate God's faithfulness in the first half of the year.",
            content: "Share testimonies and invite others to the thanksgiving service.",
            media: [],
            mediaType: "IMAGE" as unknown as CampaignMediaType,
            mediaUrl: "https://picsum.photos/seed/camp8/800/400",
            thumbnailUrl: "https://picsum.photos/seed/camp8/400/200",
            ctaText: "RSVP Now",
            ctaUrl: "https://harvesters.org/thanksgiving",
            createdById: "user-admin-1",
            status: "ARCHIVED" as unknown as CampaignStatus,
            goalType: "PARTICIPANTS" as unknown as GoalType,
            goalTarget: 3000,
            goalCurrent: 2891,
            startDate: d(-120),
            endDate: d(-90),
            publishedAt: d(-120),
            viewCount: 18234,
            clickCount: 9821,
            shareCount: 3201,
            likeCount: 5123,
            participantCount: 2891,
            createdAt: d(-125),
            updatedAt: d(-90),
        },
    ];

    // ─── Participations ──────────────────────────────────────────────────────────
    const participations: CampaignParticipation[] = [
        { id: "part-1", userId: "user-1", campaignId: "camp-1", joinedAt: d(-9), smartLinkId: "link-1-1" },
        { id: "part-2", userId: "user-1", campaignId: "camp-2", joinedAt: d(-19), smartLinkId: "link-1-2" },
        { id: "part-3", userId: "user-2", campaignId: "camp-1", joinedAt: d(-8), smartLinkId: "link-2-1" },
        { id: "part-4", userId: "user-lead-1", campaignId: "camp-1", joinedAt: d(-9) },
        { id: "part-5", userId: "user-lead-1", campaignId: "camp-2", joinedAt: d(-19) },
        { id: "part-6", userId: "user-1", campaignId: "camp-4", joinedAt: d(-4) },
    ];

    // ─── Smart Links ─────────────────────────────────────────────────────────────
    const smartLinks: SmartLink[] = [
        {
            id: "link-1-1",
            slug: "x4k9mq2",
            userId: "user-1",
            campaignId: "camp-1",
            originalUrl: "http://localhost:3000/campaigns/camp-1",
            clickCount: 143,
            uniqueClickCount: 98,
            conversionCount: 12,
            isActive: true,
            isExpired: false,
            expiresAt: d(20),
            createdAt: d(-9),
            updatedAt: d(-1),
        },
        {
            id: "link-1-2",
            slug: "p8r3zt5",
            userId: "user-1",
            campaignId: "camp-2",
            originalUrl: "http://localhost:3000/campaigns/camp-2",
            clickCount: 89,
            uniqueClickCount: 61,
            conversionCount: 7,
            isActive: true,
            isExpired: false,
            expiresAt: d(10),
            createdAt: d(-19),
            updatedAt: d(-2),
        },
        {
            id: "link-2-1",
            slug: "n6w1vy8",
            userId: "user-2",
            campaignId: "camp-1",
            originalUrl: "http://localhost:3000/campaigns/camp-1",
            clickCount: 67,
            uniqueClickCount: 45,
            conversionCount: 5,
            isActive: true,
            isExpired: false,
            expiresAt: d(20),
            createdAt: d(-8),
            updatedAt: d(-3),
        },
        {
            id: "link-lead-1",
            slug: "m2j5lk9",
            userId: "user-lead-1",
            campaignId: "camp-1",
            originalUrl: "http://localhost:3000/campaigns/camp-1",
            clickCount: 312,
            uniqueClickCount: 215,
            conversionCount: 28,
            isActive: true,
            isExpired: false,
            expiresAt: d(20),
            createdAt: d(-9),
            updatedAt: d(-1),
        },
    ];

    // ─── Link Events ─────────────────────────────────────────────────────────────
    const linkEvents: LinkEvent[] = Array.from({ length: 20 }, (_, i) => ({
        id: `event-${i + 1}`,
        linkId: smartLinks[i % smartLinks.length].id,
        smartLinkId: smartLinks[i % smartLinks.length].id,
        slug: smartLinks[i % smartLinks.length].slug,
        eventType: (i % 3 === 0 ? "CLICK" : i % 3 === 1 ? "VIEW" : "SHARE") as unknown as LinkEventType,
        type: (i % 3 === 0 ? "CLICK" : i % 3 === 1 ? "VIEW" : "SHARE") as unknown as LinkEventType,
        ipHash: `hash-${i}`,
        userAgent: "Mozilla/5.0",
        country: ["NG", "GH", "UK", "US"][i % 4],
        createdAt: d(-i),
    }));

    // ─── Referrals ───────────────────────────────────────────────────────────────
    const referrals: Referral[] = [
        {
            id: "ref-1",
            inviterId: "user-lead-1",
            inviteeId: "user-1",
            campaignId: "camp-1",
            slug: "m2j5lk9",
            createdAt: d(-9),
        },
        {
            id: "ref-2",
            inviterId: "user-1",
            inviteeId: "user-2",
            campaignId: "camp-1",
            slug: "x4k9mq2",
            createdAt: d(-7),
        },
    ];

    // ─── Donations ──────────────────────────────────────────────────────────────
    const donations: Donation[] = [
        {
            id: "don-1",
            userId: "user-1",
            campaignId: "camp-3",
            amount: 5000,
            currency: "NGN",
            status: "COMPLETED" as unknown as DonationStatus,
            reference: "TXN001",
            createdAt: d(-5),
            updatedAt: d(-5),
        },
        {
            id: "don-2",
            userId: "user-2",
            campaignId: "camp-3",
            amount: 10000,
            currency: "NGN",
            status: "COMPLETED" as unknown as DonationStatus,
            reference: "TXN002",
            createdAt: d(-4),
            updatedAt: d(-4),
        },
    ];

    // ─── Points Ledger ───────────────────────────────────────────────────────────
    const pointsLedger: PointsLedgerEntry[] = [
        { id: "pt-1", userId: "user-1", campaignId: "camp-1", type: "IMPACT" as unknown as PointType, value: 143, description: "Clicks received on smart link", createdAt: d(-9) },
        { id: "pt-2", userId: "user-1", campaignId: "camp-1", type: "LEADERSHIP" as unknown as PointType, value: 25, description: "Referral joined campaign", referenceId: "ref-2", createdAt: d(-7) },
        { id: "pt-3", userId: "user-1", campaignId: "camp-2", type: "IMPACT" as unknown as PointType, value: 89, description: "Clicks received on smart link", createdAt: d(-5) },
        { id: "pt-4", userId: "user-lead-1", campaignId: "camp-1", type: "IMPACT" as unknown as PointType, value: 312, description: "Clicks received on smart link", createdAt: d(-9) },
        { id: "pt-5", userId: "user-lead-1", campaignId: "camp-1", type: "LEADERSHIP" as unknown as PointType, value: 25, description: "Referral joined campaign", referenceId: "ref-1", createdAt: d(-9) },
        { id: "pt-6", userId: "user-lead-1", type: "CONSISTENCY" as unknown as PointType, value: 25, description: "Weekly streak bonus", createdAt: d(-7) },
        { id: "pt-7", userId: "user-2", campaignId: "camp-1", type: "IMPACT" as unknown as PointType, value: 67, description: "Clicks received on smart link", createdAt: d(-8) },
    ];

    // ─── Leaderboard Snapshots ──────────────────────────────────────────────────
    const leaderboardSnapshots: LeaderboardSnapshot[] = [
        { id: "lb-1", userId: "user-lead-1", campaignId: "camp-1", period: "2026-W03", rank: 1, score: 362, createdAt: d(-7) },
        { id: "lb-2", userId: "user-1", campaignId: "camp-1", period: "2026-W03", rank: 2, score: 257, createdAt: d(-7) },
        { id: "lb-3", userId: "user-2", campaignId: "camp-1", period: "2026-W03", rank: 3, score: 67, createdAt: d(-7) },
    ];

    // ─── Trust Scores ────────────────────────────────────────────────────────────
    const trustScores: TrustScore[] = users.map((u) => ({
        id: `trust-${u.id}`,
        userId: u.id,
        score: DEFAULT_TRUST_SCORE,
        flags: [],
        updatedAt: d(-1),
    }));

    return {
        users,
        campaigns,
        participations,
        smartLinks,
        linkEvents,
        referrals,
        donations,
        pointsLedger,
        leaderboardSnapshots,
        trustScores,
    };
}
